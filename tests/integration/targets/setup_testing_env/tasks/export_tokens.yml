---
# Export API tokens to environment variables and files for subsequent test runs

- name: Export technitium01 token to file
  copy:
    content: "{{ technitium_tokens[('technitium01' + (lookup('env', 'CONTAINER_SUFFIX') | default('')))].token }}"
    dest: "{{ lookup('env', 'TOKEN_FILE_1') | default('/tmp/technitium01_token') }}"
  when: technitium_tokens[('technitium01' + (lookup('env', 'CONTAINER_SUFFIX') | default('')))] is defined

- name: Export technitium02 token to file  
  copy:
    content: "{{ technitium_tokens[('technitium02' + (lookup('env', 'CONTAINER_SUFFIX') | default('')))].token }}"
    dest: "{{ lookup('env', 'TOKEN_FILE_2') | default('/tmp/technitium02_token') }}"
  when: technitium_tokens[('technitium02' + (lookup('env', 'CONTAINER_SUFFIX') | default('')))] is defined
